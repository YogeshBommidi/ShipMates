generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  name        String?
  email       String   @unique
  image       String?
  ownedLoads  Loads[]  @relation("Owner")
  ownedTrucks Trucks[] @relation("Owner")
}

model Loads {
  id          String       @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  description String
  price       Int
  fromAddress String
  toAddress   String
  image       String
  userEmail   String
  owner       User         @relation("Owner", fields: [userEmail], references: [email])
  truckPrices TruckPrice[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model Trucks {
  id            String       @id @default(auto()) @map("_id") @db.ObjectId
  driverName    String
  truckEmail    String
  owner         User         @relation("Owner", fields: [truckEmail], references: [email])
  license       String       @unique
  truckCapacity Int
  favLoads      String[]     @db.ObjectId
  bookedLoads   Json[]
  TruckPrice    TruckPrice[]

  @@unique(fields: [license, truckEmail])
}

model TruckPrice {
  id          String @id @default(auto()) @map("_id") @db.ObjectId
  load        Loads  @relation(fields: [loadId], references: [id])
  loadId      String @db.ObjectId
  truck       Trucks @relation(fields: [truckId], references: [id])
  truckId     String @db.ObjectId
  quotedPrice Int

  @@unique(fields: [loadId, truckId])
  @@index([loadId], name: "loadId_index")
}
